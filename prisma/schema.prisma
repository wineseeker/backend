generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id
  email         String    @unique
  password_hash String
  role          Role      @default(USER)
  sessions      Session[]
  results       Result[]
}

model Session {
  id        String   @id
  userId    String
  expiresAt DateTime
  user      User     @relation(references: [id], fields: [userId], onDelete: Cascade)
}

model Result {
  id      Int    @id @default(autoincrement())
  userId  String
  wineId  Int
  clicked Int

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  wine Wine @relation(fields: [wineId], references: [id], onDelete: Cascade)
}

model Wine {
  id              Int              @id @default(autoincrement())
  name            String?
  ratingCount     Int
  ratingAverage   Float
  typeId          Int
  results         Result[]
  characteristics Characteristic[]
}

model Characteristic {
  id          Int    @id @default(autoincrement())
  wineId      Int
  sweetness   Float
  alcohol     Float
  tannin      Float
  body        Float
  acidity     Float
  countryCode String
  grapes      String
  grapesId    String

  wine Wine @relation(fields: [wineId], references: [id], onDelete: Cascade)
}

model Food {
  id   Int     @id @default(autoincrement())
  name String?
}

model Survey {
  id        Int   @id @default(autoincrement())
  wine_type Int
  body      Float
  alcohol   Float
  acidity   Float
  sweetness Float
  tannin    Float
}

enum Role {
  USER
  ADMIN
}
